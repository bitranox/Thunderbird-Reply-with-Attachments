---
id: usage
title: 'الاستخدام'
sidebar_label: 'الاستخدام'
---

---

## الاستخدام {#usage}

- عند الرد، يضيف الملحق المرفقات الأصلية تلقائيًا — أو يسأل أولًا، إذا كان مفعّلًا في "الخيارات".
- إزالة التكرار بحسب اسم الملف؛ يتم دائمًا تجاوز أجزاء S/MIME. تتم استعادة الصور المضمّنة في نص الرد افتراضيًا (يمكن التعطيل عبر "Include inline pictures" في "الخيارات").
- يتم أيضًا تجاوز المرفقات المحظورة (أنماط glob غير حساسة لحالة الأحرف تطابق أسماء الملفات فقط، وليس المسارات). انظر [الإعدادات](configuration#blacklist-glob-patterns).

---

### ما الذي يحدث عند الرد {#what-happens}

- اكتشاف الرد → سرد المرفقات الأصلية → تصفية S/MIME + المضمّنة → تأكيد اختياري → إضافة الملفات المؤهّلة (تخطي المكرّرات) → استعادة الصور المضمّنة في نص الرسالة.

تمرير صارم مقابل تمرير مرن: يستبعد الملحق أولًا أجزاء S/MIME والأجزاء المضمّنة من مرفقات الملفات. إذا لم يتأهل شيء، يجري تمريرًا مرنًا لا يزال يستبعد S/MIME/المضمّن لكنه يتسامح مع حالات أكثر (انظر تفاصيل الكود). لا تتم إضافة الصور المضمّنة كمرفقات ملفات مطلقًا؛ بدلًا من ذلك، عند تفعيل "Include inline pictures" (الإعداد الافتراضي)، تُضمَّن مباشرة في نص الرد على شكل base64 data URIs.

| نوع الجزء                                            |             التمرير الصارم |              التمرير المرن |
| ---------------------------------------------------- | -------------------------: | -------------------------: |
| ملف توقيع S/MIME `smime.p7s`                         |                     مستبعد |                     مستبعد |
| أنواع MIME الخاصة بـ S/MIME (`application/pkcs7-*`)  |                     مستبعد |                     مستبعد |
| صورة مضمنة يُشار إليها بواسطة Content‑ID (`image/*`) | مستبعد (تُستعاد في النص\*) | مستبعد (تُستعاد في النص\*) |
| رسالة بريد مرفقة (`message/rfc822`) مع اسم ملف       |                 غير مُضافة |                   قد تُضاف |
| مرفق ملف عادي مع اسم ملف                             |                   قد تُضاف |                   قد تُضاف |

\* عند تفعيل "Include inline pictures" (الافتراضي: ON)، تُضمَّن الصور المضمّنة في نص الرد على شكل base64 data URIs بدلًا من إضافتها كمرفقات ملفات. انظر [الإعدادات](configuration#include-inline-pictures).

مثال: قد تفتقر بعض المرفقات إلى ترويسات معيّنة لكنها لا تزال ملفات عادية (ليست مضمّنة/S/MIME). إذا لم يجد التمرير الصارم شيئًا، فقد يقبل التمرير المرن تلك الحالات ويُرفقها.

---

### مراجع متبادلة {#cross-reference}

- لا يتم تعديل "إعادة التوجيه" حسب التصميم (انظر القيود أدناه).
- لأسباب قد تمنع إضافة مرفق، راجع "لماذا قد لا تتم إضافة المرفقات".

---

## تفاصيل السلوك {#behavior-details}

- منع التكرار: يعلِّم الملحق علامة تبويب الإنشاء كمُعالَجة باستخدام قيمة جلسة لكل تبويب وحارس داخل الذاكرة. لن يضيف الأصل مرتين.
- يُعامل إغلاق نافذة الإنشاء وإعادة فتحها كعلامة تبويب جديدة (أي يُسمح بمحاولة جديدة).
- احترام المرفقات الموجودة: إذا كانت نافذة الإنشاء تحتوي بالفعل على بعض المرفقات، فستُضاف الأصول مرة واحدة بالضبط، مع تخطي أسماء الملفات الموجودة مسبقًا.
- الاستبعادات: تُستبعد مصArtifacts S/MIME والصور المضمّنة من مرفقات الملفات. إذا لم يتأهل شيء في التمرير الأول، يُعاد الفحص بتمرير مرن لأجزاء غير S/MIME. تُعالَج الصور المضمّنة بشكل منفصل: تُستعاد في نص الرد كـ data URIs (عند التفعيل).
  - أسماء الملفات: `smime.p7s`
  - أنواع MIME: `application/pkcs7-signature`, `application/x-pkcs7-signature`, `application/pkcs7-mime`
  - الصور المضمّنة: أي جزء `image/*` يُشار إليه بواسطة Content‑ID — مُستبعد من مرفقات الملفات لكن يُضمَّن في نص الرد عند تفعيل "Include inline pictures"
  - رسائل البريد المرفقة (`message/rfc822`): تُعامَل كمرفقات عادية إذا كان لها اسم ملف؛ قد تُضاف (رهناً بفحوص التكرار والقائمة السوداء).
- تحذير القائمة السوداء (إن كان مفعّلًا): عندما تُستبعَد المرشحات بفعل قائمتك السوداء،
  يعرض الملحق نافذة صغيرة تسرد الملفات المتأثرة والنمط/الأنماط
  المطابقة. يظهر هذا التحذير أيضًا في الحالات التي لن تُضاف فيها أي مرفقات لأن كل شيء قد تم استبعاده.

---

## اختصارات لوحة المفاتيح {#keyboard-shortcuts}

- مربع حوار التأكيد: Y/J = نعم، N/Esc = لا؛ مفاتيح Tab/Shift+Tab وأسهم الاتجاهات تتنقّل بالتركيز.
  - يحدّد "Default answer" في [الإعدادات](configuration#confirmation) الزر المُركَّز مبدئيًا.
  - مفتاح Enter يفعّل الزر المُركّز. مفاتيح Tab/Shift+Tab والأسهم تنقل التركيز لدعم سهولة الوصول.

### ملخص اختصارات لوحة المفاتيح {#keyboard-cheat-sheet}

| المفاتيح        | الإجراء                         |
| --------------- | ------------------------------- |
| Y / J           | تأكيد نعم                       |
| N / Esc         | تأكيد لا                        |
| Enter           | تنشيط الزر المركّز              |
| Tab / Shift+Tab | نقل التركيز للأمام/للخلف        |
| مفاتيح الأسهم   | تحريك التركيز بين الأزرار       |
| Default answer  | يضبط التركيز الأولي (نعم أو لا) |

---

## القيود {#limitations}

- لا يتم تعديل "إعادة التوجيه" بواسطة هذا الملحق (الرد والرد على الكل مدعومان).
- قد تخضع المرفقات الكبيرة جدًا لقيود Thunderbird أو المزوّد.
  - لا يقوم الملحق بتجزئة الملفات أو ضغطها؛ بل يعتمد على معالجة المرفقات العادية في Thunderbird.
- الرسائل المشفّرة: تُستبعد أجزاء S/MIME عمدًا.

---

## لماذا قد لا تتم إضافة المرفقات {#why-attachments-might-not-be-added}

- لا تُضاف الصور المضمّنة كمرفقات ملفات. عندما يكون "Include inline pictures" على وضع ON (الإعداد الافتراضي)، تُضمَّن في نص الرد كـ data URIs بدلًا من ذلك. إذا كان الإعداد على OFF، تُزال الصور المضمّنة بالكامل. انظر [الإعدادات](configuration#include-inline-pictures).
- تُستبعَد أجزاء توقيع S/MIME حسب التصميم: تُتخطّى أسماء ملفات مثل `smime.p7s` وأنواع MIME مثل `application/pkcs7-signature` أو `application/pkcs7-mime`.
- يمكن لأنماط القائمة السوداء تصفية المرشّحات: انظر [الإعدادات](configuration#blacklist-glob-patterns)؛ المطابقة غير حساسة لحالة الأحرف وعلى أسماء الملفات فقط.
- لا يُعاد إضافة الأسماء المكرّرة: إذا كانت نافذة الإنشاء تحتوي بالفعل على ملف بنفس الاسم المُطبَّع، فسيتم تخطّيه.
- أجزاء غير ملفية أو أسماء ملفات مفقودة: لا تؤخذ بعين الاعتبار إلا الأجزاء الشبيهة بالملفات التي لها أسماء ملفات قابلة للاستخدام.

---

راجع أيضًا

- [الإعدادات](configuration)
